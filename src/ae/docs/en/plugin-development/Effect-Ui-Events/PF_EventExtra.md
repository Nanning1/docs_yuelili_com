---
title: PF_EventExtra
order: 3
category:
  - AE 插件开发
---
# PF_EventExtra

This structure provide context information for the current event. After Effects passes a pointer to this structure in the extra parameter of the [Entry Point](../effect-basics/entry-point.html) (#effect-basics-entry-point) function.

The `PF\_EventUnion` (sent in the `PF\_EventExtra`) varies with the event type, and contains information specific to that event.


| **Member**                           | **Purpose**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `<span class="pre">contextH</span>`      | Handle to the `<span class="pre">PF_Context</span>`.<br />This drawing context is used with the [Drawbot suites](https://ae-plugins.docsforadobe.dev/effect-ui-events/custom-ui-and-drawbot.html#effect-ui-events-custom-ui-and-drawbot) for drawing, and also for the [UI Callbacks](https://ae-plugins.docsforadobe.dev/effect-ui-events/ui-callbacks.html#effect-ui-events-ui-callbacks).                                                                                                                                                                                                                                                                                                                                                                          |
| `<span class="pre">e_type</span>`        | Which[event](https://ae-plugins.docsforadobe.dev/effect-ui-events/effect-ui-events.html#effect-ui-events-effect-ui-events) is occurring.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `<span class="pre">u</span>`             | A[PF_EventUnion](https://ae-plugins.docsforadobe.dev/effect-ui-events/PF_EventUnion.html#effect-ui-events-pf-eventunion) containing information specific to the event.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `<span class="pre">effect_win</span>`    | A `<span class="pre">PF_EffectWindowInfo</span>` about the event if it occurs within the effects window.<br />Otherwise, as of After Effects 5.0, effect_win can be replaced by a `<span class="pre">PF_WindowUnion</span>`.<br />This struct contains both a `<span class="pre">PF_EffectWindowInfo</span>` and an `<span class="pre">PF_ItemWindowInfo</span>`, which (for now) is simply the port rectangle for the item window.<br />Replacement only occurs if `<span class="pre">PF_USE_NEW_WINDOW_UNION</span>` was defined during compilation; otherwise, it will continue to be just a `<span class="pre">PF_EffectWindowInfo</span>`.                                                                                                       |
| `<span class="pre">cbs</span>`           | Pointer to[UI Callbacks](https://ae-plugins.docsforadobe.dev/effect-ui-events/ui-callbacks.html#effect-ui-events-ui-callbacks), which are needed to translate points between layer, composition, and screen coordinate systems.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| `<span class="pre">evt_in_flags</span>`  | Event Input Flags. This currently contains only one value,`<span class="pre">PF_EI_DONT_DRAW</span>`, which you should check before drawing!                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `<span class="pre">evt_out_flags</span>` | One or more of the following, combined with a bitwise OR operation:><br />*`<span class="pre">PF_EO_NONE</span>`*`<span class="pre">PF_EO_HANDLED_EVENT</span>` tells After Effects you’ve handled the event.<br />*`<span class="pre">PF_EO_ALWAYS_UPDATE</span>` forces After Effects to rerender the composite in response to every click or drag; this is the same behavior generated by ‘alt-scrubbing’ the parameter value.* `<span class="pre">PF_EO_NEVER_UPDATE</span>` prevents After Effects from rerendering the composite until the user stops clicking and dragging.<br /> `<span class="pre">PF_EO_UPDATE_NOW</span>` tells After Effects to update the view immediately after the event returns after calling PF_InvalidateRect |

---

## PF_Context

PF_Context details the event’s UI context.



| **Member**                              | **Purpose**                                                                                                                                                                                                                                                                                                                 |
| --------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `<span class="pre">magic</span>`            | Do not change.                                                                                                                                                                                                                                                                                                                    |
| `<span class="pre">w_type</span>`           | The window type. If you have Custom Comp and ECW UIs in the same plug-in, this is the way to differentiate between them (what kind of masochist are you, anyway?).> <br />*`<span class="pre">PF_Window_COMP</span>`,<br />* `<span class="pre">PF_Window_LAYER</span>`,<br />* `<span class="pre">PF_Window_EFFECT</span>` |
| `<span class="pre">reserved_flt</span>`     | Do not change.                                                                                                                                                                                                                                                                                                                    |
| `<span class="pre">plugin_state[4]</span>`  | An array of 4 `<span class="pre">A_longs</span>` which the plug-in can use to store state information for a given context.                                                                                                                                                                                                      |
| `<span class="pre">reserved_drawref</span>` | A `<span class="pre">DRAWBOT_DrawRef</span>` for use with the [Drawbot suites](https://ae-plugins.docsforadobe.dev/effect-ui-events/custom-ui-and-drawbot.html#effect-ui-events-custom-ui-and-drawbot).                                                                                                                            |
| `<span class="pre">*reserved_paneP</span>`  | Do not change.                                                                                                                                                                                                                                                                                                                    |

## PF_EffectWindowInfo

If an event occurs in the ECP, an PF_EffectWindowInfo is sent in PF_EventExtra.

| **Member**                                                                         | **Purpose**                                                                                                                          |
| ---------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| `index`                                                                                | This indicates which parameter in the effect window is being affected. The controls are numbered from 0 to the number of controls minus 1. |
| `area`                                                                                 | This indicates if the control title (`PF\_EA\_PARAM\_TITLE`) or the control itself (`PF\_EA\_CONTROL`) are being affected.             |
| The title is the area still visible when the parameter’s topic (“twirly”) is spun up. |                                                                                                                                            |
| `current\_frame`                                                                       | A PF_Rect indicating the full frame of the area occupied by the control.                                                                   |
| `param\_title\_frame`                                                                  | A PF_Rect indicating the title area of the control.                                                                                        |
| `horiz\_offset`                                                                        | A horizontal offset from the left side of the title area in which to draw into the title.                                                  |
