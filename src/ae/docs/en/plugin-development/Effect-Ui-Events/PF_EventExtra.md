---
title: PF_EventExtra
order: 3
category:
  - AE 插件开发
---

# PF_EventExtra

This structure provide context information for the current event. After Effects passes a pointer to this structure in the extra parameter of the [Entry Point](../effect-basics/entry-point.html) (#effect-basics-entry-point) function.

The `PF\_EventUnion` (sent in the `PF\_EventExtra`) varies with the event type, and contains information specific to that event.

| **Member** | **Purpose**                  |
| ---------- | ---------------------------- |
| `contextH` | Handle to the `PF\_Context`. |

This drawing context is used with the [Drawbot suites](custom-ui-and-drawbot.html) (#effect-ui-events-custom-ui-and-drawbot) for drawing,
and also for the [UI Callbacks](ui-callbacks.html) (#effect-ui-events-ui-callbacks). |
| `e\_type` | Which [event](effect-ui-events.html) (#effect-ui-events-effect-ui-events) is occurring. |
| `u` | A [PF_EventUnion](PF_EventUnion.html) (#effect-ui-events-pf-eventunion) containing information specific to the event. |
| `effect\_win` | A `PF\_EffectWindowInfo` about the event if it occurs within the effects window.
Otherwise, as of After Effects 5.0, effect_win can be replaced by a `PF\_WindowUnion`.
This struct contains both a `PF\_EffectWindowInfo` and an `PF\_ItemWindowInfo`, which (for now) is simply the port rectangle for the item window.
Replacement only occurs if `PF\_USE\_NEW\_WINDOW\_UNION` was defined during compilation; otherwise, it will continue to be just a `PF\_EffectWindowInfo`. |
| `cbs` | Pointer to [UI Callbacks](ui-callbacks.html) (#effect-ui-events-ui-callbacks), which are needed to translate points between layer, composition, and screen coordinate systems. |
| `evt\_in\_flags` | Event Input Flags. This currently contains only one value, `PF\_EI\_DONT\_DRAW`, which you should check before drawing! |
| `evt\_out\_flags` | One or more of the following, combined with a bitwise OR operation:

- `PF\_EO\_NONE`
- `PF\_EO\_HANDLED\_EVENT` tells After Effects you’ve handled the event.
- `PF\_EO\_ALWAYS\_UPDATE` forces After Effects to rerender the composite in response to every click or drag; this is the same behavior generated by ‘alt-scrubbing’ the parameter value.
- `PF\_EO\_NEVER\_UPDATE` prevents After Effects from rerendering the composite until the user stops clicking and dragging.
- `PF\_EO\_UPDATE\_NOW` tells After Effects to update the view immediately after the event returns after calling PF_InvalidateRect

|

---

## PF_Context

PF_Context details the event’s UI context.

| **Member** | **Purpose**                                                               |
| ---------- | ------------------------------------------------------------------------- |
| `magic`    | Do not change.                                                            |
| `w\_type`  | The window type. If you have Custom Comp and ECW UIs in the same plug-in, |

this is the way to differentiate between them (what kind of masochist are you, anyway?).

- `PF\_Window\_COMP`,
- `PF\_Window\_LAYER`,
- `PF\_Window\_EFFECT`

|
| `reserved\_flt` | Do not change. |
| `plugin\_state[4]` | An array of 4 `A\_longs` which the plug-in can use to store state information for a given context. |
| `reserved\_drawref` | A `DRAWBOT\_DrawRef` for use with the [Drawbot suites](custom-ui-and-drawbot.html) (#effect-ui-events-custom-ui-and-drawbot). |
| `\*reserved\_paneP` | Do not change. |

---

## PF_EffectWindowInfo

If an event occurs in the ECP, an PF_EffectWindowInfo is sent in PF_EventExtra.

| **Member**                                                                            | **Purpose**                                                                                                                                |
| ------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| `index`                                                                               | This indicates which parameter in the effect window is being affected. The controls are numbered from 0 to the number of controls minus 1. |
| `area`                                                                                | This indicates if the control title (`PF\_EA\_PARAM\_TITLE`) or the control itself (`PF\_EA\_CONTROL`) are being affected.                 |
| The title is the area still visible when the parameter’s topic (“twirly”) is spun up. |
| `current\_frame`                                                                      | A PF_Rect indicating the full frame of the area occupied by the control.                                                                   |
| `param\_title\_frame`                                                                 | A PF_Rect indicating the title area of the control.                                                                                        |
| `horiz\_offset`                                                                       | A horizontal offset from the left side of the title area in which to draw into the title.                                                  |
