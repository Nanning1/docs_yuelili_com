---
title: PiPL Resources
order: 12
category:
  - AE 插件开发
---

# PiPL Resources

起源于20多年前的Adobe Photoshop，插件属性列表，或称PiPLs，是在不执行插件的情况下，提供有关插件行为的基本信息的资源。PiPLs在After Effects中已被`PF_Cmd_GLOBAL_SETUP`(见[全局选择器](.../effect-basics/command-selectors.html)(#effect-basics-command-selectors-global-selectors))和动态外标所取代。然而，出于考古学的原因，在 "PF_Cmd_GLOBAL_SETUP "过程中指示的行为必须与PiPL中的行为一致。

PiPL指定了一个插件的入口点，显示名称，以及插件的匹配名称。匹配名称是一个唯一的、恒定的标识符，与插件的显示名称不同，后者可以动态地改变。从CC开始，显示名称的长度可以达到47个字符。以前，它们被限制为31个字符。

为了实现跨平台的兼容性，请为你的插件的macOS和Windows版本使用一个.r文件，就像样本那样。PiPL属性必须始终以macOS特有的字节顺序排列。在Windows上，PiPLs是通过pipltool.exe处理.r文件来编译的，它将.r文件转换为二进制.rc文件。Windows示例项目都包含自定义构建步骤，使用跨平台的.r文件和我们的cnvtpipl.exe命令行工具，生成一个.rc文件。以现有的样本插件为基础进行开发，构建步骤将被正确实现。

## Entry Point

你的插件的入口点是通过PiPL在Windows和macOS上输出的。如果该插件支持多个平台，那么必须在PiPL中定义多个入口点。不需要Windows .def文件或手动导出，除非你还指定了一些其他操作系统的入口点。

entry.h中定义的宏(在\SDKExamplesHeaders目录下)负责导出每个样本的入口点函数。所有样本项目的入口点函数对效果来说是EffectMain()，对AEGP来说是EntryPointFunc()。

## PiPL Resources And Microsoft Visual Studio

要用pipltool生成的资源来使用来自Microsoft Visual Studio .NET的资源。

#include the output of the custom build steps into the Microsoft-generated .rc file.

```cpp
// in file WhizBang.rc, generated by .NET.
#include "WhizBang_PiPL_temp.rc" // pipltool.exe's output

```

如果修改一个样本插件，请将pipltool.exe生成的文件名改为WhizBang_PiPL_temp.rc这样的名字，否则每次构建时都会覆盖微软的资源；这不是好事。

## Multiple PiPLs

在同一个文件中包含多个插件(包括AEGP和特效)，使用多个PiPLs是可能的，但不推荐。如果在同一个文件中同时有AEGP和特效的PiPLs，那么AEGPs必须排在第一位。

没有其他主机(甚至Premiere Pro)支持在同一个.dll或代码片段中的多个PiPLs指向多个效果。另外，如果你需要更新一个插件，你真的想把你所有的插件都换成新的版本吗？我们建议每个代码片段使用一个PiPL和一个插件。

## Super Secret PiPL Bit

对于那些使用C++的人来说，必须一直保持你的插件被加载(以避免你的v-table被破坏，以及其他危害)，将PiPL的AE_Reserved_Info成员设置为8。多年来，我们一直很严格，坚持要求插件成为良好的内存公民，并对被卸载作出优雅的反应。我们知道在有些情况下，被卸载时没有任何警告会毁掉一个插件的一天(和v表)，所以我们提供了这个变通办法。善待自己，严格管理内存，只用你的力量去做好事。

## Why Do I Need To Know All This?

你不需要，After Effects需要。如果你听从我们的建议，以SDK样本为基础，你可以简单地修改包含PiPL定义的.r文件，你的插件资源将在你下次构建时自动更新。感受爱。或者，如果你曾经修改过自定义的构建步骤，请感受一下痛苦。